<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ibis_starburst_nyctaxi_final</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="ibis_starburst_NYCTaxi_final_files/libs/clipboard/clipboard.min.js"></script>
<script src="ibis_starburst_NYCTaxi_final_files/libs/quarto-html/quarto.js"></script>
<script src="ibis_starburst_NYCTaxi_final_files/libs/quarto-html/popper.min.js"></script>
<script src="ibis_starburst_NYCTaxi_final_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ibis_starburst_NYCTaxi_final_files/libs/quarto-html/anchor.min.js"></script>
<link href="ibis_starburst_NYCTaxi_final_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ibis_starburst_NYCTaxi_final_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ibis_starburst_NYCTaxi_final_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ibis_starburst_NYCTaxi_final_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ibis_starburst_NYCTaxi_final_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<p>This notebook example involves using a managed version of Trino (Starburst). It will work without Starburst provided you are able to import data into a Trino cluster connected to a lake. We will be using one month of Yellow Taxi data from https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page and a zone look up file provided on the same page. Please download both files and register in either your Starburst or Trino cluster before proceeding.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ibis</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>ibis.options.interactive <span class="op">=</span> <span class="va">True</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#from trino.auth import OAuth2Authentication</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>IMPORTANT!!!! Change your user, host, port, database, schema and roles to be relevant to your Starburst Galaxy setup. If you are using OAuth2, uncomment the keyword lines roles, and auth. Then comment PASSWORD to proceed. You can reference: https://ibis-project.org/backends/trino#connecting-to-starburst-managed-trino-instances for more information.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> ibis.trino.<span class="ex">connect</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  user<span class="op">=</span>os.environ[<span class="st">'user'</span>],</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  host<span class="op">=</span>os.environ[<span class="st">'host'</span>],</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  password<span class="op">=</span>os.environ[<span class="st">'password'</span>],</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  port<span class="op">=</span><span class="dv">443</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  database<span class="op">=</span>os.environ[<span class="st">'database'</span>],</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  schema<span class="op">=</span>os.environ[<span class="st">'schema'</span>],</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#roles="accountadmin",</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#auth=OAuth2Authentication(),</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  http_scheme<span class="op">=</span><span class="st">"https"</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Within Ibis con.list_tables() allows us to list all the tables.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>con.list_tables()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>['groupbyboroughtrips', 'taxizonenyc', 'zonelookup']</code></pre>
</div>
</div>
<p>Ibis tables in trino can be referenced through the use of con.table. We’re going to create two reference ibis tables to Trino from our tables below:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>nycjantrips <span class="op">=</span> con.table(<span class="st">"taxizonenyc"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>zonelookup <span class="op">=</span> con.table(<span class="st">"zonelookup"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In Ibis we can check the schema of the tables we just referenced through .schema()</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>nycjantrips.schema()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>ibis.Schema {
  vendorid               int64
  tpep_pickup_datetime   timestamp(3)
  tpep_dropoff_datetime  timestamp(3)
  passenger_count        float64
  trip_distance          float64
  ratecodeid             float64
  store_and_fwd_flag     string
  pulocationid           int64
  dolocationid           int64
  payment_type           int64
  fare_amount            float64
  extra                  float64
  mta_tax                float64
  tip_amount             float64
  tolls_amount           float64
  improvement_surcharge  float64
  total_amount           float64
  congestion_surcharge   float64
  airport_fee            float64
}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>zonelookup.schema()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>ibis.Schema {
  locationid    string
  borough       string
  zone          string
  service_zone  string
}</code></pre>
</div>
</div>
<p>We’re going to preview the dataset with ibis slice method. We can see the first 10 rows here. We also included ibis.options.interactive = True at the start of our notebook which allows us to display the ibis tables in a prettified way.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>nycjantrips[<span class="dv">0</span>:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> vendorid </span>┃<span style="font-weight: bold"> tpep_pickup_datetime </span>┃<span style="font-weight: bold"> tpep_dropoff_datetime </span>┃<span style="font-weight: bold"> passenger_count </span>┃<span style="font-weight: bold"> trip_distance </span>┃<span style="font-weight: bold"> ratecodeid </span>┃<span style="font-weight: bold"> store_and_fwd_flag </span>┃<span style="font-weight: bold"> pulocationid </span>┃<span style="font-weight: bold"> dolocationid </span>┃<span style="font-weight: bold"> payment_type </span>┃<span style="font-weight: bold"> fare_amount </span>┃<span style="font-weight: bold"> extra   </span>┃<span style="font-weight: bold"> mta_tax </span>┃<span style="font-weight: bold"> tip_amount </span>┃<span style="font-weight: bold"> tolls_amount </span>┃<span style="font-weight: bold"> improvement_surcharge </span>┃<span style="font-weight: bold"> total_amount </span>┃<span style="font-weight: bold"> congestion_surcharge </span>┃<span style="font-weight: bold"> airport_fee </span>┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │
├──────────┼──────────────────────┼───────────────────────┼─────────────────┼───────────────┼────────────┼────────────────────┼──────────────┼──────────────┼──────────────┼─────────────┼─────────┼─────────┼────────────┼──────────────┼───────────────────────┼──────────────┼──────────────────────┼─────────────┤
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:32:10</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:40:36</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.97</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">161</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">141</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.3</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.00</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.30</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:55:08</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 01:01:27</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.10</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">237</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.9</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.00</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.90</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:25:04</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:37:49</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.51</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">238</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.9</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.00</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.90</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:03:48</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:13:25</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.90</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.1</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.25</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.85</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.25</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:10:29</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:21:19</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.43</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">107</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">79</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.4</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.00</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.28</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.68</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:50:34</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 01:02:52</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.84</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">161</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">137</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.8</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.00</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.80</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:09:22</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:19:49</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.66</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">239</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">143</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.1</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.00</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.42</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.52</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:27:12</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:49:56</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.70</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">142</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.7</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.00</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.74</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64.44</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:21:44</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:36:40</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.95</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">164</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">236</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.7</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.00</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.68</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.38</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:39:42</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:50:36</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.01</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">141</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">107</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.9</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.00</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.90</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
└──────────┴──────────────────────┴───────────────────────┴─────────────────┴───────────────┴────────────┴────────────────────┴──────────────┴──────────────┴──────────────┴─────────────┴─────────┴─────────┴────────────┴──────────────┴───────────────────────┴──────────────┴──────────────────────┴─────────────┘
</pre>
</div>
</div>
<p>To understand the dataset a little more we can try an order by. Looks like there are some columns with passenger count of undefined. In this case we’re going to want to curate the dataset and clean it up a bit to ensure more accurate data.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>nycjantrips.order_by(nycjantrips.trip_distance.desc())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> vendorid </span>┃<span style="font-weight: bold"> tpep_pickup_datetime </span>┃<span style="font-weight: bold"> tpep_dropoff_datetime </span>┃<span style="font-weight: bold"> passenger_count </span>┃<span style="font-weight: bold"> trip_distance </span>┃<span style="font-weight: bold"> ratecodeid </span>┃<span style="font-weight: bold"> store_and_fwd_flag </span>┃<span style="font-weight: bold"> pulocationid </span>┃<span style="font-weight: bold"> dolocationid </span>┃<span style="font-weight: bold"> payment_type </span>┃<span style="font-weight: bold"> fare_amount </span>┃<span style="font-weight: bold"> extra   </span>┃<span style="font-weight: bold"> mta_tax </span>┃<span style="font-weight: bold"> tip_amount </span>┃<span style="font-weight: bold"> tolls_amount </span>┃<span style="font-weight: bold"> improvement_surcharge </span>┃<span style="font-weight: bold"> total_amount </span>┃<span style="font-weight: bold"> congestion_surcharge </span>┃<span style="font-weight: bold"> airport_fee </span>┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │
├──────────┼──────────────────────┼───────────────────────┼─────────────────┼───────────────┼────────────┼────────────────────┼──────────────┼──────────────┼──────────────┼─────────────┼─────────┼─────────┼────────────┼──────────────┼───────────────────────┼──────────────┼──────────────────────┼─────────────┤
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-23 17:14:00</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-23 17:20:00</span>   │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">258928.15</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">238</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">239</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.65</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.53</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.18</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-07 18:18:00</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-07 18:47:00</span>   │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">225987.37</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">261</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">263</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">56.49</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.10</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">72.59</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-15 08:33:00</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-15 08:43:00</span>   │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">187872.33</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">229</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">142</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.02</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.60</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.62</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-13 05:53:00</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-13 06:02:00</span>   │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">116439.71</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">239</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">230</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.22</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.22</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-31 07:18:00</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-31 07:57:00</span>   │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">85543.66</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">87</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.90</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.90</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51.80</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-12 08:45:00</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-12 09:09:00</span>   │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76886.52</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">148</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.49</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.10</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.59</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 19:40:43</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 20:21:48</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62359.52</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">79</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.50</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-31 21:24:00</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-31 21:28:00</span>   │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">52042.30</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">236</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">75</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.40</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.84</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.24</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-22 11:25:00</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-22 11:33:00</span>   │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33205.32</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">230</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.87</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.37</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.24</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-23 07:29:00</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-23 07:51:00</span>   │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16562.61</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span>               │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">262</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">90</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.87</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.93</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.80</span> │                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">NULL</span> │
│        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                     │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                  │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└──────────┴──────────────────────┴───────────────────────┴─────────────────┴───────────────┴────────────┴────────────────────┴──────────────┴──────────────┴──────────────┴─────────────┴─────────┴─────────┴────────────┴──────────────┴───────────────────────┴──────────────┴──────────────────────┴─────────────┘
</pre>
</div>
</div>
<p>We can chain together expressions with filter - similar to a WHERE clause in SQL. We can see nan (not a number) involved, ibis also has built-in support for that.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>nyc_filtered <span class="op">=</span> nycjantrips.<span class="bu">filter</span>((nycjantrips.passenger_count <span class="op">!=</span> <span class="dv">0</span>) <span class="op">|</span> (nycjantrips.passenger_count.isnan() <span class="kw">is</span> <span class="va">False</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>nyc_filtered</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> vendorid </span>┃<span style="font-weight: bold"> tpep_pickup_datetime </span>┃<span style="font-weight: bold"> tpep_dropoff_datetime </span>┃<span style="font-weight: bold"> passenger_count </span>┃<span style="font-weight: bold"> trip_distance </span>┃<span style="font-weight: bold"> ratecodeid </span>┃<span style="font-weight: bold"> store_and_fwd_flag </span>┃<span style="font-weight: bold"> pulocationid </span>┃<span style="font-weight: bold"> dolocationid </span>┃<span style="font-weight: bold"> payment_type </span>┃<span style="font-weight: bold"> fare_amount </span>┃<span style="font-weight: bold"> extra   </span>┃<span style="font-weight: bold"> mta_tax </span>┃<span style="font-weight: bold"> tip_amount </span>┃<span style="font-weight: bold"> tolls_amount </span>┃<span style="font-weight: bold"> improvement_surcharge </span>┃<span style="font-weight: bold"> total_amount </span>┃<span style="font-weight: bold"> congestion_surcharge </span>┃<span style="font-weight: bold"> airport_fee </span>┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │
├──────────┼──────────────────────┼───────────────────────┼─────────────────┼───────────────┼────────────┼────────────────────┼──────────────┼──────────────┼──────────────┼─────────────┼─────────┼─────────┼────────────┼──────────────┼───────────────────────┼──────────────┼──────────────────────┼─────────────┤
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:32:10</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:40:36</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.97</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">161</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">141</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.30</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:55:08</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 01:01:27</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.10</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">237</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.9</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.90</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:25:04</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:37:49</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.51</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">238</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.9</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.90</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:10:29</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:21:19</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.43</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">107</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">79</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.28</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.68</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:50:34</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 01:02:52</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.84</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">161</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">137</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.8</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.80</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:09:22</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:19:49</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.66</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">239</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">143</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.42</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.52</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:27:12</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:49:56</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.70</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">142</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.7</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.74</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64.44</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:21:44</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:36:40</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.95</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">164</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">236</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.7</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.68</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.38</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:39:42</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:50:36</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.01</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">141</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">107</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.9</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.90</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:53:01</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 01:01:45</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.80</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">234</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.28</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.68</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │
│        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                     │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                  │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└──────────┴──────────────────────┴───────────────────────┴─────────────────┴───────────────┴────────────┴────────────────────┴──────────────┴──────────────┴──────────────┴─────────────┴─────────┴─────────┴────────────┴──────────────┴───────────────────────┴──────────────┴──────────────────────┴─────────────┘
</pre>
</div>
</div>
<p>You can see with the command below that nan has been filtered out!</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>nyc_filtered.order_by(nyc_filtered.trip_distance.desc())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> vendorid </span>┃<span style="font-weight: bold"> tpep_pickup_datetime </span>┃<span style="font-weight: bold"> tpep_dropoff_datetime </span>┃<span style="font-weight: bold"> passenger_count </span>┃<span style="font-weight: bold"> trip_distance </span>┃<span style="font-weight: bold"> ratecodeid </span>┃<span style="font-weight: bold"> store_and_fwd_flag </span>┃<span style="font-weight: bold"> pulocationid </span>┃<span style="font-weight: bold"> dolocationid </span>┃<span style="font-weight: bold"> payment_type </span>┃<span style="font-weight: bold"> fare_amount </span>┃<span style="font-weight: bold"> extra   </span>┃<span style="font-weight: bold"> mta_tax </span>┃<span style="font-weight: bold"> tip_amount </span>┃<span style="font-weight: bold"> tolls_amount </span>┃<span style="font-weight: bold"> improvement_surcharge </span>┃<span style="font-weight: bold"> total_amount </span>┃<span style="font-weight: bold"> congestion_surcharge </span>┃<span style="font-weight: bold"> airport_fee </span>┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │
├──────────┼──────────────────────┼───────────────────────┼─────────────────┼───────────────┼────────────┼────────────────────┼──────────────┼──────────────┼──────────────┼─────────────┼─────────┼─────────┼────────────┼──────────────┼───────────────────────┼──────────────┼──────────────────────┼─────────────┤
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 19:40:43</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 20:21:48</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62359.52</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">79</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.50</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-31 15:53:23</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-31 16:50:38</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14098.55</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">142</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">132</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">74.00</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-23 08:18:50</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-23 08:47:22</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9947.03</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">239</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">140</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23.3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.91</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.21</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-26 15:20:46</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-26 16:01:48</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9684.00</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">164</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">265</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">97.9</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.98</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.00</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">149.88</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-18 19:37:41</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-18 20:14:29</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9683.76</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">264</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">112</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">63.9</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.00</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">74.15</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.25</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-03 15:25:05</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-03 16:09:02</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9680.61</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">264</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">244</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.22</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61.32</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-18 19:43:55</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-18 20:02:33</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9679.83</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">264</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35.2</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.5</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.00</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.45</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.25</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-05 15:26:43</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-05 16:04:17</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9679.73</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">264</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">244</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.53</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.55</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76.43</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.25</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-19 19:36:58</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-19 20:01:44</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9675.57</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">264</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">151</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.58</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.08</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-09 15:44:58</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-09 16:02:35</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9674.67</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">264</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">239</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.7</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.20</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │
│        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                     │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                  │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└──────────┴──────────────────────┴───────────────────────┴─────────────────┴───────────────┴────────────┴────────────────────┴──────────────┴──────────────┴──────────────┴─────────────┴─────────┴─────────┴────────────┴──────────────┴───────────────────────┴──────────────┴──────────────────────┴─────────────┘
</pre>
</div>
</div>
<p>Let’s add a column to our dataset. I want to add a column to help calculate the average ride duration. We are going to use the Ibis ‘Delta’ function for this result Ibis is also pretty cool and can simply visualize a column in isolation:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ride_duration <span class="op">=</span> nyc_filtered.tpep_dropoff_datetime.delta(nyc_filtered.tpep_pickup_datetime, <span class="st">"minute"</span>).name(<span class="st">"rideminutes"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>ride_duration</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> rideminutes </span>┃
┡━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │
├─────────────┤
│           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │
│           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │
│          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │
│          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │
│          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │
│          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span> │
│          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │
│          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span> │
│          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │
│           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │
│           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└─────────────┘
</pre>
</div>
</div>
<p>We can also combine the column with our original table using the ‘mutate’ method shown here.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>nycjanduration <span class="op">=</span> nyc_filtered.mutate(rideminutes<span class="op">=</span>nyc_filtered.tpep_dropoff_datetime.delta(nyc_filtered.tpep_pickup_datetime, <span class="st">"minute"</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>nycjanduration[<span class="st">"vendorid"</span>,<span class="st">"rideminutes"</span>,<span class="st">"trip_distance"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> vendorid </span>┃<span style="font-weight: bold"> rideminutes </span>┃<span style="font-weight: bold"> trip_distance </span>┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │
├──────────┼─────────────┼───────────────┤
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.97</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.10</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.51</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.43</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.84</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.66</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.70</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.95</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.01</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.80</span> │
│        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└──────────┴─────────────┴───────────────┘
</pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>nycjanduration[<span class="st">"vendorid"</span>,<span class="st">"rideminutes"</span>,<span class="st">"trip_distance"</span>].head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> vendorid </span>┃<span style="font-weight: bold"> rideminutes </span>┃<span style="font-weight: bold"> trip_distance </span>┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │
├──────────┼─────────────┼───────────────┤
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.97</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.10</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.51</span> │
└──────────┴─────────────┴───────────────┘
</pre>
</div>
</div>
<p>Next up are some basic analytics and aggregations in Ibis - let’s get total revenue with sum(), longest trip with max(), and average trip duration with mean(). Ibis is able to chain expressions similar to pandas.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#some basic analytics - let's get total revenue, longest trip. </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>insights <span class="op">=</span> nycjanduration.agg(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        ibis._.count().name(<span class="st">"total_trips"</span>),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"total_amount"</span>].<span class="bu">sum</span>().name(<span class="st">"total_revenue"</span>),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"trip_distance"</span>].<span class="bu">sum</span>().name(<span class="st">"total_distance_all"</span>),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"rideminutes"</span>].<span class="bu">max</span>().name(<span class="st">"longest"</span>),    </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"rideminutes"</span>].mean().<span class="bu">round</span>(<span class="dv">2</span>).name(<span class="st">"average_ride"</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>insights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> total_trips </span>┃<span style="font-weight: bold"> total_revenue </span>┃<span style="font-weight: bold"> total_distance_all </span>┃<span style="font-weight: bold"> longest </span>┃<span style="font-weight: bold"> average_ride </span>┃
┡━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │
├─────────────┼───────────────┼────────────────────┼─────────┼──────────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2943859</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.953883e+07</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.015018e+07</span> │   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10030</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.69</span> │
└─────────────┴───────────────┴────────────────────┴─────────┴──────────────┘
</pre>
</div>
</div>
<p>Wait, the longest trip seems a bit… lengthy… Note: we added a .round function to display the average ride more nicely. Let’s check out the ride itself.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>nycjanduration.<span class="bu">filter</span>(nycjanduration[<span class="st">"rideminutes"</span>] <span class="op">==</span> <span class="dv">10030</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> vendorid </span>┃<span style="font-weight: bold"> tpep_pickup_datetime </span>┃<span style="font-weight: bold"> tpep_dropoff_datetime </span>┃<span style="font-weight: bold"> passenger_count </span>┃<span style="font-weight: bold"> trip_distance </span>┃<span style="font-weight: bold"> ratecodeid </span>┃<span style="font-weight: bold"> store_and_fwd_flag </span>┃<span style="font-weight: bold"> pulocationid </span>┃<span style="font-weight: bold"> dolocationid </span>┃<span style="font-weight: bold"> payment_type </span>┃<span style="font-weight: bold"> fare_amount </span>┃<span style="font-weight: bold"> extra   </span>┃<span style="font-weight: bold"> mta_tax </span>┃<span style="font-weight: bold"> tip_amount </span>┃<span style="font-weight: bold"> tolls_amount </span>┃<span style="font-weight: bold"> improvement_surcharge </span>┃<span style="font-weight: bold"> total_amount </span>┃<span style="font-weight: bold"> congestion_surcharge </span>┃<span style="font-weight: bold"> airport_fee </span>┃<span style="font-weight: bold"> rideminutes </span>┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │
├──────────┼──────────────────────┼───────────────────────┼─────────────────┼───────────────┼────────────┼────────────────────┼──────────────┼──────────────┼──────────────┼─────────────┼─────────┼─────────┼────────────┼──────────────┼───────────────────────┼──────────────┼──────────────────────┼─────────────┼─────────────┤
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-23 11:21:51</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-30 10:31:02</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">207</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">95</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.5</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10030</span> │
└──────────┴──────────────────────┴───────────────────────┴─────────────────┴───────────────┴────────────┴────────────────────┴──────────────┴──────────────┴──────────────┴─────────────┴─────────┴─────────┴────────────┴──────────────┴───────────────────────┴──────────────┴──────────────────────┴─────────────┴─────────────┘
</pre>
</div>
</div>
<p>7 day trip? looks like the trip distance is zero, we can decide to remove the row from future calculations of average Let’s remove the outliers and join with a lookup table to get more information about the “where” of our analytical datasets - zones.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>nycjanduration_new <span class="op">=</span> (</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    nycjanduration.<span class="bu">filter</span>(nycjanduration.trip_distance <span class="op">!=</span> <span class="fl">0.0</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>nycjanduration_new</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> vendorid </span>┃<span style="font-weight: bold"> tpep_pickup_datetime </span>┃<span style="font-weight: bold"> tpep_dropoff_datetime </span>┃<span style="font-weight: bold"> passenger_count </span>┃<span style="font-weight: bold"> trip_distance </span>┃<span style="font-weight: bold"> ratecodeid </span>┃<span style="font-weight: bold"> store_and_fwd_flag </span>┃<span style="font-weight: bold"> pulocationid </span>┃<span style="font-weight: bold"> dolocationid </span>┃<span style="font-weight: bold"> payment_type </span>┃<span style="font-weight: bold"> fare_amount </span>┃<span style="font-weight: bold"> extra   </span>┃<span style="font-weight: bold"> mta_tax </span>┃<span style="font-weight: bold"> tip_amount </span>┃<span style="font-weight: bold"> tolls_amount </span>┃<span style="font-weight: bold"> improvement_surcharge </span>┃<span style="font-weight: bold"> total_amount </span>┃<span style="font-weight: bold"> congestion_surcharge </span>┃<span style="font-weight: bold"> airport_fee </span>┃<span style="font-weight: bold"> rideminutes </span>┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │
├──────────┼──────────────────────┼───────────────────────┼─────────────────┼───────────────┼────────────┼────────────────────┼──────────────┼──────────────┼──────────────┼─────────────┼─────────┼─────────┼────────────┼──────────────┼───────────────────────┼──────────────┼──────────────────────┼─────────────┼─────────────┤
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:32:10</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:40:36</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.97</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">161</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">141</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.30</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:55:08</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 01:01:27</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.10</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">237</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.9</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.90</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:25:04</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:37:49</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.51</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">238</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.9</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.90</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:10:29</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:21:19</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.43</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">107</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">79</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.28</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.68</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:50:34</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 01:02:52</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.84</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">161</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">137</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.8</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.80</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:09:22</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:19:49</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.66</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">239</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">143</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.42</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.52</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:27:12</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:49:56</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.70</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">142</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.7</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.74</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64.44</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:21:44</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:36:40</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.95</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">164</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">236</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.7</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.68</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.38</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:39:42</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:50:36</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.01</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">141</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">107</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.9</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.90</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:53:01</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 01:01:45</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.80</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">234</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.28</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.68</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │
│        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                     │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                  │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │
└──────────┴──────────────────────┴───────────────────────┴─────────────────┴───────────────┴────────────┴────────────────────┴──────────────┴──────────────┴──────────────┴─────────────┴─────────┴─────────┴────────────┴──────────────┴───────────────────────┴──────────────┴──────────────────────┴─────────────┴─────────────┘
</pre>
</div>
</div>
<p>Let’s create a cleaner set similar to before.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>insights_new <span class="op">=</span> nycjanduration_new.agg(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        ibis._.count().name(<span class="st">"total_trips"</span>),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"total_amount"</span>].<span class="bu">sum</span>().name(<span class="st">"total_revenue"</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"trip_distance"</span>].<span class="bu">sum</span>().name(<span class="st">"total_distance_all"</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"rideminutes"</span>].<span class="bu">max</span>().name(<span class="st">"longest"</span>),    </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        ibis._[<span class="st">"rideminutes"</span>].mean().<span class="bu">round</span>(<span class="dv">2</span>).name(<span class="st">"average_ride"</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>insights_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> total_trips </span>┃<span style="font-weight: bold"> total_revenue </span>┃<span style="font-weight: bold"> total_distance_all </span>┃<span style="font-weight: bold"> longest </span>┃<span style="font-weight: bold"> average_ride </span>┃
┡━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>            │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>   │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │
├─────────────┼───────────────┼────────────────────┼─────────┼──────────────┤
│     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2906670</span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.838373e+07</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.015018e+07</span> │    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6179</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.76</span> │
└─────────────┴───────────────┴────────────────────┴─────────┴──────────────┘
</pre>
</div>
</div>
<p>You can already see a slightly more massaged dataset - the longest trip is lower, alongside average_ride has changed and the total number of trips has gone down by almost 40k</p>
<p>Next up we want to do something more powerful - join with related datasets to get more insights on geographical behaviour of taxi trips around NYC. Let’s look over the zonelookup table again.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>zonelookup</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> locationid </span>┃<span style="font-weight: bold"> borough       </span>┃<span style="font-weight: bold"> zone                    </span>┃<span style="font-weight: bold"> service_zone </span>┃
┡━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>       │
├────────────┼───────────────┼─────────────────────────┼──────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">1         </span> │ <span style="color: #008000; text-decoration-color: #008000">EWR          </span> │ <span style="color: #008000; text-decoration-color: #008000">Newark Airport         </span> │ <span style="color: #008000; text-decoration-color: #008000">EWR         </span> │
│ <span style="color: #008000; text-decoration-color: #008000">2         </span> │ <span style="color: #008000; text-decoration-color: #008000">Queens       </span> │ <span style="color: #008000; text-decoration-color: #008000">Jamaica Bay            </span> │ <span style="color: #008000; text-decoration-color: #008000">Boro Zone   </span> │
│ <span style="color: #008000; text-decoration-color: #008000">3         </span> │ <span style="color: #008000; text-decoration-color: #008000">Bronx        </span> │ <span style="color: #008000; text-decoration-color: #008000">Allerton/Pelham Gardens</span> │ <span style="color: #008000; text-decoration-color: #008000">Boro Zone   </span> │
│ <span style="color: #008000; text-decoration-color: #008000">4         </span> │ <span style="color: #008000; text-decoration-color: #008000">Manhattan    </span> │ <span style="color: #008000; text-decoration-color: #008000">Alphabet City          </span> │ <span style="color: #008000; text-decoration-color: #008000">Yellow Zone </span> │
│ <span style="color: #008000; text-decoration-color: #008000">5         </span> │ <span style="color: #008000; text-decoration-color: #008000">Staten Island</span> │ <span style="color: #008000; text-decoration-color: #008000">Arden Heights          </span> │ <span style="color: #008000; text-decoration-color: #008000">Boro Zone   </span> │
│ <span style="color: #008000; text-decoration-color: #008000">6         </span> │ <span style="color: #008000; text-decoration-color: #008000">Staten Island</span> │ <span style="color: #008000; text-decoration-color: #008000">Arrochar/Fort Wadsworth</span> │ <span style="color: #008000; text-decoration-color: #008000">Boro Zone   </span> │
│ <span style="color: #008000; text-decoration-color: #008000">7         </span> │ <span style="color: #008000; text-decoration-color: #008000">Queens       </span> │ <span style="color: #008000; text-decoration-color: #008000">Astoria                </span> │ <span style="color: #008000; text-decoration-color: #008000">Boro Zone   </span> │
│ <span style="color: #008000; text-decoration-color: #008000">8         </span> │ <span style="color: #008000; text-decoration-color: #008000">Queens       </span> │ <span style="color: #008000; text-decoration-color: #008000">Astoria Park           </span> │ <span style="color: #008000; text-decoration-color: #008000">Boro Zone   </span> │
│ <span style="color: #008000; text-decoration-color: #008000">9         </span> │ <span style="color: #008000; text-decoration-color: #008000">Queens       </span> │ <span style="color: #008000; text-decoration-color: #008000">Auburndale             </span> │ <span style="color: #008000; text-decoration-color: #008000">Boro Zone   </span> │
│ <span style="color: #008000; text-decoration-color: #008000">10        </span> │ <span style="color: #008000; text-decoration-color: #008000">Queens       </span> │ <span style="color: #008000; text-decoration-color: #008000">Baisley Park           </span> │ <span style="color: #008000; text-decoration-color: #008000">Boro Zone   </span> │
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>            │
└────────────┴───────────────┴─────────────────────────┴──────────────┘
</pre>
</div>
</div>
<p>We can see pulocationid is int64, so we must cast to have the tables fully joined. Ibis supports casting data types within its library as well. In the line below, we use .cast(“str”) to ensure the two tables can be joined together. You can try without the cast and see what happens :).</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>joineddata <span class="op">=</span> nycjanduration_new.inner_join(zonelookup, nycjanduration_new.pulocationid.cast(<span class="st">"str"</span>) <span class="op">==</span> zonelookup.locationid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>joineddata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> vendorid </span>┃<span style="font-weight: bold"> tpep_pickup_datetime </span>┃<span style="font-weight: bold"> tpep_dropoff_datetime </span>┃<span style="font-weight: bold"> passenger_count </span>┃<span style="font-weight: bold"> trip_distance </span>┃<span style="font-weight: bold"> ratecodeid </span>┃<span style="font-weight: bold"> store_and_fwd_flag </span>┃<span style="font-weight: bold"> pulocationid </span>┃<span style="font-weight: bold"> dolocationid </span>┃<span style="font-weight: bold"> payment_type </span>┃<span style="font-weight: bold"> fare_amount </span>┃<span style="font-weight: bold"> extra   </span>┃<span style="font-weight: bold"> mta_tax </span>┃<span style="font-weight: bold"> tip_amount </span>┃<span style="font-weight: bold"> tolls_amount </span>┃<span style="font-weight: bold"> improvement_surcharge </span>┃<span style="font-weight: bold"> total_amount </span>┃<span style="font-weight: bold"> congestion_surcharge </span>┃<span style="font-weight: bold"> airport_fee </span>┃<span style="font-weight: bold"> rideminutes </span>┃<span style="font-weight: bold"> locationid </span>┃<span style="font-weight: bold"> borough   </span>┃<span style="font-weight: bold"> zone                  </span>┃<span style="font-weight: bold"> service_zone </span>┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">timestamp(3)</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>             │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>        │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>               │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>              │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>       │
├──────────┼──────────────────────┼───────────────────────┼─────────────────┼───────────────┼────────────┼────────────────────┼──────────────┼──────────────┼──────────────┼─────────────┼─────────┼─────────┼────────────┼──────────────┼───────────────────────┼──────────────┼──────────────────────┼─────────────┼─────────────┼────────────┼───────────┼───────────────────────┼──────────────┤
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:32:10</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:40:36</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.97</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">161</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">141</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.3</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.30</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │ <span style="color: #008000; text-decoration-color: #008000">161       </span> │ <span style="color: #008000; text-decoration-color: #008000">Manhattan</span> │ <span style="color: #008000; text-decoration-color: #008000">Midtown Center       </span> │ <span style="color: #008000; text-decoration-color: #008000">Yellow Zone </span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:55:08</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 01:01:27</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.10</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">237</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.9</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.90</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> │ <span style="color: #008000; text-decoration-color: #008000">43        </span> │ <span style="color: #008000; text-decoration-color: #008000">Manhattan</span> │ <span style="color: #008000; text-decoration-color: #008000">Central Park         </span> │ <span style="color: #008000; text-decoration-color: #008000">Yellow Zone </span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:25:04</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:37:49</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.51</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">238</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.9</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.90</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │ <span style="color: #008000; text-decoration-color: #008000">48        </span> │ <span style="color: #008000; text-decoration-color: #008000">Manhattan</span> │ <span style="color: #008000; text-decoration-color: #008000">Clinton East         </span> │ <span style="color: #008000; text-decoration-color: #008000">Yellow Zone </span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:10:29</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:21:19</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.43</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">107</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">79</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.28</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.68</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │ <span style="color: #008000; text-decoration-color: #008000">107       </span> │ <span style="color: #008000; text-decoration-color: #008000">Manhattan</span> │ <span style="color: #008000; text-decoration-color: #008000">Gramercy             </span> │ <span style="color: #008000; text-decoration-color: #008000">Yellow Zone </span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:50:34</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 01:02:52</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.84</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">161</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">137</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.8</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.80</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> │ <span style="color: #008000; text-decoration-color: #008000">161       </span> │ <span style="color: #008000; text-decoration-color: #008000">Manhattan</span> │ <span style="color: #008000; text-decoration-color: #008000">Midtown Center       </span> │ <span style="color: #008000; text-decoration-color: #008000">Yellow Zone </span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:09:22</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:19:49</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.66</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">239</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">143</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.1</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.42</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.52</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span> │ <span style="color: #008000; text-decoration-color: #008000">239       </span> │ <span style="color: #008000; text-decoration-color: #008000">Manhattan</span> │ <span style="color: #008000; text-decoration-color: #008000">Upper West Side South</span> │ <span style="color: #008000; text-decoration-color: #008000">Yellow Zone </span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:27:12</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:49:56</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.70</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">142</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.7</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.74</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64.44</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> │ <span style="color: #008000; text-decoration-color: #008000">142       </span> │ <span style="color: #008000; text-decoration-color: #008000">Manhattan</span> │ <span style="color: #008000; text-decoration-color: #008000">Lincoln Square East  </span> │ <span style="color: #008000; text-decoration-color: #008000">Yellow Zone </span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:21:44</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:36:40</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.95</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">164</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">236</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.7</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.68</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.38</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span> │ <span style="color: #008000; text-decoration-color: #008000">164       </span> │ <span style="color: #008000; text-decoration-color: #008000">Manhattan</span> │ <span style="color: #008000; text-decoration-color: #008000">Midtown South        </span> │ <span style="color: #008000; text-decoration-color: #008000">Yellow Zone </span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:39:42</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:50:36</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.01</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">141</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">107</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.9</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.90</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span> │ <span style="color: #008000; text-decoration-color: #008000">141       </span> │ <span style="color: #008000; text-decoration-color: #008000">Manhattan</span> │ <span style="color: #008000; text-decoration-color: #008000">Lenox Hill West      </span> │ <span style="color: #008000; text-decoration-color: #008000">Yellow Zone </span> │
│        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 00:53:01</span>  │ <span style="color: #800080; text-decoration-color: #800080">2023-01-01 01:01:45</span>   │             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.80</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │ <span style="color: #008000; text-decoration-color: #008000">N                 </span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">234</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68</span> │            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.4</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.28</span> │          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │                   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.68</span> │                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5</span> │         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span> │           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span> │ <span style="color: #008000; text-decoration-color: #008000">234       </span> │ <span style="color: #008000; text-decoration-color: #008000">Manhattan</span> │ <span style="color: #008000; text-decoration-color: #008000">Union Sq             </span> │ <span style="color: #008000; text-decoration-color: #008000">Yellow Zone </span> │
│        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                    │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                     │               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                  │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │                    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │           <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span> │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>          │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>                     │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">…</span>            │
└──────────┴──────────────────────┴───────────────────────┴─────────────────┴───────────────┴────────────┴────────────────────┴──────────────┴──────────────┴──────────────┴─────────────┴─────────┴─────────┴────────────┴──────────────┴───────────────────────┴──────────────┴──────────────────────┴─────────────┴─────────────┴────────────┴───────────┴───────────────────────┴──────────────┘
</pre>
</div>
</div>
<p>Now we can do more cool things in ibis with group bys and aggregate by with zones and boroughs!</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>groupbyboroughtrips <span class="op">=</span> (</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    joineddata</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    .group_by(<span class="st">"zone"</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    .aggregate(</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        trips<span class="op">=</span>joineddata.vendorid.count(),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        totalrev<span class="op">=</span>joineddata.fare_amount.<span class="bu">sum</span>(),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        totalpassengers<span class="op">=</span>joineddata.passenger_count.<span class="bu">sum</span>(),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        averageride<span class="op">=</span>joineddata.rideminutes.mean().<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    .order_by(ibis.desc(<span class="st">"totalrev"</span>))</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    .limit(<span class="dv">10</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>groupbyboroughtrips</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> zone                         </span>┃<span style="font-weight: bold"> trips  </span>┃<span style="font-weight: bold"> totalrev     </span>┃<span style="font-weight: bold"> totalpassengers </span>┃<span style="font-weight: bold"> averageride </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │
├──────────────────────────────┼────────┼──────────────┼─────────────────┼─────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">JFK Airport                 </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">154492</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.148091e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">223590.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.12</span> │
│ <span style="color: #008000; text-decoration-color: #008000">LaGuardia Airport           </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">87352</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.577509e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">118834.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.77</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Midtown Center              </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">130031</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.956489e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">179987.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.58</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Upper East Side South       </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">142043</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.732204e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">191430.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.78</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Upper East Side North       </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">131581</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.708854e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">179243.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.53</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Times Sq/Theatre District   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">95098</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.623739e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">140826.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.71</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Penn Station/Madison Sq West</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">105566</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.619161e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">142369.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.60</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Midtown East                </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">101456</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.490681e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">136471.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.05</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Lincoln Square East         </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">95530</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.282554e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">133103.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.64</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Murray Hill                 </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">84567</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.237674e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">114587.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.50</span> │
└──────────────────────────────┴────────┴──────────────┴─────────────────┴─────────────┘
</pre>
</div>
</div>
<p>If you want to see what sql ibis generates, you can use the ibis.to_sql() method.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ibis.to_sql(groupbyboroughtrips)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div class="sourceCode" id="cb27"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> t0 <span class="kw">AS</span> (</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    t3.vendorid <span class="kw">AS</span> vendorid,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    t3.tpep_pickup_datetime <span class="kw">AS</span> tpep_pickup_datetime,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    t3.tpep_dropoff_datetime <span class="kw">AS</span> tpep_dropoff_datetime,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    t3.passenger_count <span class="kw">AS</span> passenger_count,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    t3.trip_distance <span class="kw">AS</span> trip_distance,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    t3.ratecodeid <span class="kw">AS</span> ratecodeid,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    t3.store_and_fwd_flag <span class="kw">AS</span> store_and_fwd_flag,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    t3.pulocationid <span class="kw">AS</span> pulocationid,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    t3.dolocationid <span class="kw">AS</span> dolocationid,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    t3.payment_type <span class="kw">AS</span> payment_type,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    t3.fare_amount <span class="kw">AS</span> fare_amount,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    t3.extra <span class="kw">AS</span> extra,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    t3.mta_tax <span class="kw">AS</span> mta_tax,</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    t3.tip_amount <span class="kw">AS</span> tip_amount,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    t3.tolls_amount <span class="kw">AS</span> tolls_amount,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    t3.improvement_surcharge <span class="kw">AS</span> improvement_surcharge,</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    t3.total_amount <span class="kw">AS</span> total_amount,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    t3.congestion_surcharge <span class="kw">AS</span> congestion_surcharge,</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    t3.airport_fee <span class="kw">AS</span> airport_fee</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> dh_nyctaxi_video.taxizonenyc <span class="kw">AS</span> t3</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    t3.passenger_count <span class="op">&lt;&gt;</span> <span class="dv">0</span> <span class="kw">OR</span> <span class="kw">FALSE</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>), t1 <span class="kw">AS</span> (</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    t0.vendorid <span class="kw">AS</span> vendorid,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    t0.tpep_pickup_datetime <span class="kw">AS</span> tpep_pickup_datetime,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    t0.tpep_dropoff_datetime <span class="kw">AS</span> tpep_dropoff_datetime,</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    t0.passenger_count <span class="kw">AS</span> passenger_count,</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>    t0.trip_distance <span class="kw">AS</span> trip_distance,</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    t0.ratecodeid <span class="kw">AS</span> ratecodeid,</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    t0.store_and_fwd_flag <span class="kw">AS</span> store_and_fwd_flag,</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    t0.pulocationid <span class="kw">AS</span> pulocationid,</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    t0.dolocationid <span class="kw">AS</span> dolocationid,</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    t0.payment_type <span class="kw">AS</span> payment_type,</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    t0.fare_amount <span class="kw">AS</span> fare_amount,</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    t0.extra <span class="kw">AS</span> extra,</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>    t0.mta_tax <span class="kw">AS</span> mta_tax,</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>    t0.tip_amount <span class="kw">AS</span> tip_amount,</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>    t0.tolls_amount <span class="kw">AS</span> tolls_amount,</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>    t0.improvement_surcharge <span class="kw">AS</span> improvement_surcharge,</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>    t0.total_amount <span class="kw">AS</span> total_amount,</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>    t0.congestion_surcharge <span class="kw">AS</span> congestion_surcharge,</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>    t0.airport_fee <span class="kw">AS</span> airport_fee,</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>    DATE_DIFF(</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>      <span class="st">'minute'</span>,</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>      DATE_TRUNC(<span class="st">'minute'</span>, t0.tpep_pickup_datetime),</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>      DATE_TRUNC(<span class="st">'minute'</span>, t0.tpep_dropoff_datetime)</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>    ) <span class="kw">AS</span> rideminutes</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t0</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>    t0.trip_distance <span class="op">&lt;&gt;</span> <span class="fl">0.0</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>  t2.<span class="dt">zone</span>,</span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>  t2.trips,</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>  t2.totalrev,</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>  t2.totalpassengers,</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>  t2.averageride</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> (</span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>    t3.<span class="dt">zone</span> <span class="kw">AS</span> <span class="dt">zone</span>,</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(t1.vendorid) <span class="kw">AS</span> trips,</span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(t1.fare_amount) <span class="kw">AS</span> totalrev,</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(t1.passenger_count) <span class="kw">AS</span> totalpassengers,</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROUND</span>(<span class="fu">AVG</span>(t1.rideminutes), <span class="dv">2</span>) <span class="kw">AS</span> averageride</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> t1</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>  <span class="kw">JOIN</span> dh_nyctaxi_video.zonelookup <span class="kw">AS</span> t3</span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> <span class="fu">CAST</span>(t1.pulocationid <span class="kw">AS</span> <span class="dt">VARCHAR</span>) <span class="op">=</span> t3.locationid</span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>  <span class="kw">GROUP</span> <span class="kw">BY</span></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span></span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>) <span class="kw">AS</span> t2</span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>  t2.totalrev <span class="kw">DESC</span></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Airport rides give the most revenue to taxi companies, that makes a lot of sense.</p>
<p>Let’s write our result tables back to trino (to show some write functionality, of course).</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>con.create_table(<span class="st">"groupbyboroughtrips_new"</span>, groupbyboroughtrips)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> zone                         </span>┃<span style="font-weight: bold"> trips  </span>┃<span style="font-weight: bold"> totalrev     </span>┃<span style="font-weight: bold"> totalpassengers </span>┃<span style="font-weight: bold"> averageride </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━┩
│ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">string</span>                       │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">int64</span>  │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>      │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>         │ <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">float64</span>     │
├──────────────────────────────┼────────┼──────────────┼─────────────────┼─────────────┤
│ <span style="color: #008000; text-decoration-color: #008000">JFK Airport                 </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">154492</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.148091e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">223590.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.12</span> │
│ <span style="color: #008000; text-decoration-color: #008000">LaGuardia Airport           </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">87352</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.577509e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">118834.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.77</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Midtown Center              </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">130031</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.956489e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">179987.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.58</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Upper East Side South       </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">142043</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.732204e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">191430.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.78</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Upper East Side North       </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">131581</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.708854e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">179243.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.53</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Times Sq/Theatre District   </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">95098</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.623739e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">140826.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.71</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Penn Station/Madison Sq West</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">105566</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.619161e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">142369.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.60</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Midtown East                </span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">101456</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.490681e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">136471.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.05</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Lincoln Square East         </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">95530</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.282554e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">133103.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.64</span> │
│ <span style="color: #008000; text-decoration-color: #008000">Murray Hill                 </span> │  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">84567</span> │ <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.237674e+06</span> │        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">114587.0</span> │       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.50</span> │
└──────────────────────────────┴────────┴──────────────┴─────────────────┴─────────────┘
</pre>
</div>
</div>
<p>There you have it, a quick tutorial with Ibis, and Starburst Galaxy!</p>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>